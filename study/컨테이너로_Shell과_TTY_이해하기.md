# ✔️ Shell

## 터미널

- 셸을 실행시키기 위한 터미널 에뮬레이터(프로그램)
- 사용자가 명령어를 입력하고 출력 결과를 보는 창을 제공
- 입출력이 가능한 터미널과 OS 커널을 연결해, 컴퓨팅(연산 작업)을 수행
- 사용자에게 명령어를 입력받고 그 명령어를 시스템의 **셸**로 전달하여 실행

## 셸

- 명령어 해석기(Command Interpreter)
- 터미널에서 사용자가 입력한 명령을 해석하고 실행하는 역할
- Mac에서 기본 셸은 **zsh** (Z Shell)
- 시스템 명령을 실행하거나 파일을 조작하고, 프로세스를 관리하는 등 다양한 작업을 처리

<br>

# ✔️ TTY

- 과거 의미: 초기 컴퓨터에서는 키보드와 프린터를 사용해 입력/출력을 수행하던 물리적 장치
- 현대적 의미: 현재는 **터미널 세션** 또는 **가상 터미널**을 의미, 명령어 입력과 출력이 가능한 소프트웨어 환경
- 물리적 TTY: 키보드와 모니터가 연결된 실제 터미널 장치
- 가상 TTY: 소프트웨어로 에뮬레이션된 터미널  

## Linux/Unix에서 TTY

### 가상 콘솔

- Linux에서는 시스템 부팅 시 여러 개의 가상 콘솔(Virtual Console)이 생성
- 각 콘솔은 TTY 장치로 할당
- 특정 하드웨어 장치를 통해 텍스트 기반의 입력과 출력을 처리하는 방식
- 텍스트 기반 터미널
- ex. `/dev/tty1`, `/dev/tty2`, ...

### Pseudo TTY (PTY)

- 네트워크 연결(이나 GUI 터미널)에서 사용하는 가상 TTY
- 소프트웨어로 구현된 가상 터미널
- SSH 세션 등
- PTY는 `/dev/pts/` 디렉토리 아래 생성

<br>

# 🤔 테스트
> **하나의 터미널로 컨테이너를 실행시키고,**  
> **또 다른 터미널에서 해당 컨테이너에 접속했을 때**  
> **본 터미널에서 컨테이너와 관련된 정보를 확인해보면?**

<br>

```bash
[root@fca3f12837ae /]# w
 17:45:48 up  3:10,  0 users,  load average: 0.12, 0.14, 0.11
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
```

컨테이너에는 로그인을 통한 유저 인증 기능도 없고, 유저 자체를 관리하지 않기 때문에 출력되는 것이 없음

<br>

```bash
[root@fca3f12837ae /]# ps
  PID TTY          TIME CMD
    1 pts/0    00:00:00 bash
   30 pts/0    00:00:00 ps
   
[root@fca3f12837ae /]# tty
/dev/pts/0
```

본 터미널에서 실행되고 있는 프로세스는  
1. 컨테이너가 시작될 때 기본으로 실행된 셸(bash)
2. 실행한 명령어(ps)  

컨테이너는 기본적으로 호스트 시스템의 물리적 터미널에 직접 연결되지 않으며,  
대신 **가상화된 터미널**(PTY)을 사용하여 **터미널 세션을 에뮬레이션하기 때문에 주소가** `/dev/pts/0`으로 나타남

<br>

```bash
[root@fca3f12837ae /]# ps ax
  PID TTY      STAT   TIME COMMAND
    1 pts/0    Ss     0:00 bash
   15 pts/1    Ss+    0:00 bash
   33 pts/0    R+     0:00 ps ax
```

- ps: 현재 터미널 세션에 연결되어 **실행 중**인 프로세스 표시  
- a: 현재 터미널 세션과 관련된 **모든** 프로세스를 포함하여 표시  
- x: **터미널에 연결되지 않은** 프로세스도 포함하여 모든 프로세스를 나열  

⇒ **ps ax**: 현재 시스템(여기서는 컨테이너) 내에서 실행 중인 프로세스를 출력

<br>

cf. 호스트 시스템(Mac)에서 tty 명령어를 쳐보면?

```bash
mimi@MacBook-Pro-3 ~ % tty 
/dev/ttys002
```

TTY를 사용하는 걸 알 수 있음

<br>
<br>

### Ref.
<15단계로 배우는 도커와 쿠버네티스>  
https://www.44bits.io/ko/keyword/command-line-interface-cli-shell-and-terminal
